{"version":3,"sources":["../../../src/lib/uh-api.ts"],"sourcesContent":["const UH_API_URL = process.env.UH_API_URL!;\n\nexport interface UHClass {\n    catalog_nbr: string;\n    course_title: string;\n    instructor_name: string;\n    enrl_cap: number;\n    enrl_tot: number;\n    subject: string;\n    class_section?: string;\n    schedule_day_time?: string;\n    building_descr?: string;\n    enrl_stat?: string;\n    class_nbr?: string;\n}\n\nexport interface ClassSearchResult {\n    data: UHClass[];\n    total: number;\n}\n\n/**\n * Fetch all open classes for a given subject\n */\nexport async function fetchOpenClasses(term: string, subject: string): Promise<ClassSearchResult> {\n    const body = new URLSearchParams({\n        term,\n        subject,\n        classStatus: 'open',\n    });\n\n    const response = await fetch(UH_API_URL, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: body.toString(),\n    });\n\n    if (!response.ok) {\n        throw new Error(`UH API error: ${response.statusText}`);\n    }\n\n    return response.json();\n}\n\n/**\n * Search for a specific class\n */\nexport async function searchClass(\n    term: string,\n    subject: string,\n    catalogNbr: string\n): Promise<UHClass | null> {\n    const body = new URLSearchParams({\n        term,\n        subject,\n        catalogNumber: catalogNbr,\n        weekendu: '0',\n    });\n\n    const url = UH_API_URL;\n    console.log('Searching class:', { url, body: body.toString() });\n\n    const response = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: body.toString(),\n    });\n\n    console.log('Response status:', response.status, response.statusText);\n\n    if (!response.ok) {\n        throw new Error(`UH API error: ${response.statusText}`);\n    }\n\n    const result: ClassSearchResult = await response.json();\n\n    return result.data.find(c => c.catalog_nbr === catalogNbr) || null;\n}\n\n/**\n * Get ALL sections for a specific class\n */\nexport async function getAllSections(\n    term: string,\n    subject: string,\n    catalogNbr: string\n): Promise<UHClass[]> {\n    const body = new URLSearchParams({\n        term,\n        subject,\n        catalogNumber: catalogNbr,\n    });\n\n    const response = await fetch(UH_API_URL, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: body.toString(),\n    });\n\n    if (!response.ok) {\n        throw new Error(`UH API error: ${response.statusText}`);\n    }\n\n    const result: ClassSearchResult = await response.json();\n\n    // Return all sections that match the catalog number\n    return result.data.filter(c => c.catalog_nbr === catalogNbr);\n}\n\n/**\n * Get available seats for a class\n */\nexport function getAvailableSeats(classData: UHClass): number {\n    return classData.enrl_cap - classData.enrl_tot;\n}\n\n/**\n * Check if a class is open\n */\nexport function isClassOpen(classData: UHClass): boolean {\n    return getAvailableSeats(classData) > 0;\n}\n\n// Current term code - configurable via environment variable\n// Default: 2280 (Spring 2028) - Update UH_CURRENT_TERM env var each semester\nexport const CURRENT_TERM = process.env.UH_CURRENT_TERM || '2280';\n\n// Common UH subjects\nexport const UH_SUBJECTS = [\n    'COSC', 'MATH', 'PHYS', 'CHEM', 'BIOL', 'ENGL', 'HIST',\n    'POLS', 'PSYC', 'ECON', 'ACCT', 'FINA', 'MANA', 'MARK',\n    'ECE', 'MECE', 'CHEE', 'CIVE', 'INDE', 'PETR',\n];\n"],"names":[],"mappings":"uCAAA,IAAM,EAAa,QAAQ,GAAG,CAAC,UAAU,CAwBlC,eAAe,EAAiB,CAAY,CAAE,CAAe,EAChE,IAAM,EAAO,IAAI,gBAAgB,CAC7B,eACA,EACA,YAAa,MACjB,GAEM,EAAW,MAAM,MAAM,EAAY,CACrC,OAAQ,OACR,QAAS,CACL,eAAgB,mCACpB,EACA,KAAM,EAAK,QAAQ,EACvB,GAEA,GAAI,CAAC,EAAS,EAAE,CACZ,CADc,KACJ,AAAJ,MAAU,CAAC,cAAc,EAAE,EAAS,UAAU,CAAA,CAAE,EAG1D,OAAO,EAAS,IAAI,EACxB,CAKO,eAAe,EAClB,CAAY,CACZ,CAAe,CACf,CAAkB,EAElB,IAAM,EAAO,IAAI,gBAAgB,MAC7B,UACA,EACA,cAAe,EACf,SAAU,GACd,GAGA,QAAQ,GAAG,CAAC,mBAAoB,CAAE,MAAK,KAAM,EAAK,QAAQ,EAAG,GAE7D,IAAM,EAAW,MAAM,MAAM,AAHjB,EAGsB,CAC9B,OAAQ,OACR,QAAS,CACL,eAAgB,mCACpB,EACA,KAAM,EAAK,QAAQ,EACvB,GAIA,GAFA,QAAQ,GAAG,CAAC,mBAAoB,EAAS,MAAM,CAAE,EAAS,UAAU,EAEhE,CAAC,EAAS,EAAE,CACZ,CADc,KACR,AAAI,MAAM,CAAC,cAAc,EAAE,EAAS,UAAU,CAAA,CAAE,EAK1D,MAAO,CAF2B,MAAM,EAAS,IAAI,EAAA,EAEvC,IAAI,CAAC,IAAI,CAAC,GAAK,EAAE,WAAW,GAAK,IAAe,IAClE,CAKO,eAAe,EAClB,CAAY,CACZ,CAAe,CACf,CAAkB,EAElB,IAAM,EAAO,IAAI,gBAAgB,MAC7B,UACA,EACA,cAAe,CACnB,GAEM,EAAW,MAAM,MAAM,EAAY,CACrC,OAAQ,OACR,QAAS,CACL,eAAgB,mCACpB,EACA,KAAM,EAAK,QAAQ,EACvB,GAEA,GAAI,CAAC,EAAS,EAAE,CACZ,CADc,KACR,AAAI,MAAM,CAAC,cAAc,EAAE,EAAS,UAAU,CAAA,CAAE,EAM1D,MAAO,CAH2B,MAAM,EAAS,IAAI,EAAA,EAGvC,IAAI,CAAC,MAAM,CAAC,GAAK,EAAE,WAAW,GAAK,EACrD,CAKO,SAAS,EAAkB,CAAkB,EAChD,OAAO,EAAU,QAAQ,CAAG,EAAU,QAAQ,AAClD,CAKO,SAAS,EAAY,CAAkB,EAC1C,OAAO,EAAkB,GAAa,CAC1C,CAIO,IAAM,EAAe,QAAQ,GAAG,CAAC,eAAe,EAAI,+CAGhC,CACvB,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAChD,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAChD,MAAO,OAAQ,OAAQ,OAAQ,OAAQ,OAC1C"}