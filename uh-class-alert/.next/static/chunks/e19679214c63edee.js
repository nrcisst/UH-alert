(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,s,t)=>{s.exports=e.r(76562)},30257,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566);function r(){let e=(0,a.useRouter)(),[r,l]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[o,c]=(0,t.useState)(!1),[d,x]=(0,t.useState)(""),[m,h]=(0,t.useState)(""),[u,p]=(0,t.useState)(""),[g,j]=(0,t.useState)(""),[v,f]=(0,t.useState)(null),[b,N]=(0,t.useState)({}),[w,y]=(0,t.useState)(!1),k=async()=>{try{let s=await fetch("/api/subscriptions");if(401===s.status)return void e.push("/");let t=await s.json();l(t.subscriptions||[])}catch(e){console.error("Failed to fetch subscriptions:",e)}finally{n(!1)}};(0,t.useEffect)(()=>{k()},[]);let C=async e=>{e.preventDefault(),p(""),j(""),c(!0);try{let e=await fetch(`/api/classes/search?subject=${d.toUpperCase()}&catalogNbr=${m}`),s=await e.json();if(!s.found){p("Class not found. Please check the subject and catalog number."),c(!1);return}let t=await fetch("/api/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:d.toUpperCase(),catalogNbr:m,title:s.class.title})}),a=await t.json();t.ok?(j(`Added ${d.toUpperCase()} ${m} to your watchlist!`),x(""),h(""),k()):p(a.error||"Failed to add class")}catch{p("Failed to add class")}finally{c(!1)}},S=async e=>{try{(await fetch(`/api/subscriptions/${e}`,{method:"DELETE"})).ok&&l(s=>s.filter(s=>s.id!==e))}catch(e){console.error("Failed to remove class:",e)}},A=async()=>{await fetch("/api/auth/logout",{method:"POST"}),e.push("/")},$=async e=>{let s=`${e.subject}-${e.catalogNbr}`;if(v===s)return void f(null);if(f(s),!b[s]){y(!0);try{let t=await fetch(`/api/classes/cached-sections?subject=${e.subject}&catalogNbr=${e.catalogNbr}`),a=await t.json();a.sections&&0!==a.sections.length||(t=await fetch(`/api/classes/sections?subject=${e.subject}&catalogNbr=${e.catalogNbr}`),a=await t.json()),N(e=>({...e,[s]:a.sections||[]}))}catch(e){console.error("Failed to fetch sections:",e)}finally{y(!1)}}};return i?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-[var(--foreground-muted)]",children:"Loading..."})}):(0,s.jsxs)("div",{className:"min-h-screen hero-gradient",children:[(0,s.jsx)("header",{className:"sticky top-0 z-50",children:(0,s.jsxs)("div",{className:"max-w-5xl mx-auto px-6 py-4 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("img",{src:"/University_of_Houston_Logo.svg.png",alt:"UH",className:"w-8 h-8"}),(0,s.jsx)("span",{className:"font-semibold text-lg tracking-tight",children:"Alert"})]}),(0,s.jsxs)("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm text-[var(--foreground-muted)] hover:text-[var(--foreground)] hover:bg-[var(--glass)] border border-transparent hover:border-[var(--glass-border)] transition-all duration-200",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),(0,s.jsx)("polyline",{points:"16 17 21 12 16 7"}),(0,s.jsx)("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign out"]})]})}),(0,s.jsxs)("main",{className:"max-w-5xl mx-auto px-6 py-10",children:[(0,s.jsxs)("div",{className:"mb-10",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold tracking-tight mb-2",children:"Your Watchlist"}),(0,s.jsx)("p",{className:"text-[var(--foreground-muted)]",children:"Add classes to track and get notified when seats open up."})]}),(0,s.jsxs)("div",{className:"card mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Add a Class"}),(0,s.jsx)("form",{onSubmit:C,className:"flex flex-col gap-4",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm text-[var(--foreground-muted)] mb-2",children:"Subject Code"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>x(e.target.value.toUpperCase()),placeholder:"e.g. COSC",className:"input w-full",maxLength:4,required:!0})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm text-[var(--foreground-muted)] mb-2",children:"Course Number"}),(0,s.jsx)("input",{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"e.g. 3320",className:"input w-full",maxLength:5,required:!0})]}),(0,s.jsx)("div",{className:"sm:self-end",children:(0,s.jsx)("button",{type:"submit",className:"btn-primary w-full sm:w-auto",disabled:o,children:o?"Adding...":"Add to Watchlist"})})]})}),u&&(0,s.jsx)("p",{className:"mt-3 text-red-400 text-sm",children:u}),g&&(0,s.jsx)("p",{className:"mt-3 text-green-400 text-sm",children:g})]}),0===r.length?(0,s.jsx)("div",{className:"card text-center py-12",children:(0,s.jsx)("p",{className:"text-[var(--foreground-muted)]",children:"No classes on your watchlist yet. Add one above!"})}):(0,s.jsx)("div",{className:"space-y-4",children:r.map((e,t)=>{let a=`${e.subject}-${e.catalogNbr}`,r=v===a;return(0,s.jsxs)("div",{className:"card animate-fade-in overflow-hidden",style:{animationDelay:`${.1*t}s`},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between cursor-pointer group",onClick:()=>$(e),children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:`w-3 h-3 rounded-full ${e.isOpen?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.5)]":"bg-red-500 shadow-[0_0_10px_rgba(239,68,68,0.5)]"}`}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-semibold text-lg tracking-tight",children:[e.subject," ",e.catalogNbr]}),e.title&&(0,s.jsx)("p",{className:"text-[var(--foreground-muted)] text-sm",children:e.title})]})]}),(0,s.jsxs)("div",{className:"mt-3 ml-7 text-sm flex items-center gap-3",children:[e.isOpen?(0,s.jsxs)("span",{className:"text-green-400 font-medium",children:[e.seatsAvailable," seat",1!==e.seatsAvailable?"s":""," available"]}):(0,s.jsx)("span",{className:"text-[var(--foreground-muted)]",children:"Currently closed"}),(0,s.jsx)("span",{className:"text-[var(--foreground-muted)] opacity-60",children:"Click to view all sections"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`text-[var(--foreground-muted)] transition-transform duration-200 ${r?"rotate-180":""}`,children:(0,s.jsx)("polyline",{points:"6 9 12 15 18 9"})}),(0,s.jsx)("button",{onClick:s=>{s.stopPropagation(),S(e.id)},className:"opacity-0 group-hover:opacity-100 text-[var(--foreground-muted)] hover:text-red-400 hover:bg-red-500/10 transition-all duration-200 p-2 rounded-lg",title:"Remove from watchlist",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M3 6h18"}),(0,s.jsx)("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),(0,s.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]})})]})]}),r&&(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-[var(--glass-border)]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 text-xs text-[var(--foreground-muted)]",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),"Cached data - updated every 15 minutes"]}),w?(0,s.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-[var(--uh-red)] border-t-transparent rounded-full animate-spin"})}):0===(b[a]||[]).filter(e=>e.isOpen).length?(0,s.jsx)("p",{className:"text-[var(--foreground-muted)] text-sm text-center py-4",children:"No open sections in cache. Add the class to trigger a live fetch."}):(0,s.jsx)("div",{className:"space-y-3",children:(b[a]||[]).filter(e=>e.isOpen).map((e,t)=>(0,s.jsx)("div",{className:"flex items-start justify-between p-3 rounded-lg bg-[var(--background)]/50 hover:bg-[var(--background)]/80 transition-colors",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),(0,s.jsx)("span",{className:"font-medium",children:e.instructor||"TBA"}),(0,s.jsxs)("span",{className:"text-green-400 text-sm",children:[e.seatsAvailable," open"]})]}),(0,s.jsxs)("div",{className:"mt-1 text-sm text-[var(--foreground-muted)] ml-4",children:[(0,s.jsxs)("p",{children:["Section ",e.section," • ",e.schedule||"TBA"]}),(0,s.jsxs)("p",{children:[e.location||"TBA"," • ",e.enrollmentTotal,"/",e.enrollmentCap," enrolled"]})]})]})},e.classNbr||t))}),e.lastChecked&&(0,s.jsxs)("p",{className:"mt-3 text-xs text-[var(--foreground-muted)] opacity-60",children:["Last checked: ",new Date(e.lastChecked).toLocaleString()]})]})]},e.id)})}),(0,s.jsx)("div",{className:"mt-8 p-4 rounded-lg bg-[var(--background-tertiary)] text-sm text-[var(--foreground-muted)]",children:(0,s.jsx)("p",{children:"We check for class openings every 15 minutes. When a seat opens up, you'll receive an email notification immediately."})})]})]})}e.s(["default",()=>r])}]);