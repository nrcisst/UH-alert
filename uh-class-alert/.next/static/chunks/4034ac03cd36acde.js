(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,s,t)=>{s.exports=e.r(76562)},30257,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566);function l(){let e=(0,a.useRouter)(),[l,i]=(0,t.useState)([]),[r,c]=(0,t.useState)(!0),[n,d]=(0,t.useState)(!1),[o,m]=(0,t.useState)(""),[x,u]=(0,t.useState)(""),[h,p]=(0,t.useState)(""),[j,f]=(0,t.useState)(""),b=async()=>{try{let s=await fetch("/api/subscriptions");if(401===s.status)return void e.push("/");let t=await s.json();i(t.subscriptions||[])}catch(e){console.error("Failed to fetch subscriptions:",e)}finally{c(!1)}};(0,t.useEffect)(()=>{b()},[]);let v=async e=>{e.preventDefault(),p(""),f(""),d(!0);try{let e=await fetch(`/api/classes/search?subject=${o.toUpperCase()}&catalogNbr=${x}`),s=await e.json();if(!s.found){p("Class not found. Please check the subject and catalog number."),d(!1);return}let t=await fetch("/api/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:o.toUpperCase(),catalogNbr:x,title:s.class.title})}),a=await t.json();t.ok?(f(`Added ${o.toUpperCase()} ${x} to your watchlist!`),m(""),u(""),b()):p(a.error||"Failed to add class")}catch{p("Failed to add class")}finally{d(!1)}},N=async e=>{try{(await fetch(`/api/subscriptions/${e}`,{method:"DELETE"})).ok&&i(s=>s.filter(s=>s.id!==e))}catch(e){console.error("Failed to remove class:",e)}},g=async()=>{await fetch("/api/auth/logout",{method:"POST"}),e.push("/")};return r?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-[var(--foreground-muted)]",children:"Loading..."})}):(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)("header",{className:"border-b border-[var(--border)] p-4",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-2xl",children:"ðŸ””"}),(0,s.jsx)("span",{className:"font-bold text-xl",children:"UH Class Alert"})]}),(0,s.jsx)("button",{onClick:g,className:"btn-secondary text-sm",children:"Logout"})]})}),(0,s.jsxs)("main",{className:"max-w-4xl mx-auto p-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Your Watchlist"}),(0,s.jsxs)("div",{className:"card mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add a Class"}),(0,s.jsxs)("form",{onSubmit:v,className:"flex flex-col sm:flex-row gap-3",children:[(0,s.jsx)("input",{type:"text",value:o,onChange:e=>m(e.target.value),placeholder:"Subject (e.g., COSC)",className:"input sm:w-32",maxLength:4,required:!0}),(0,s.jsx)("input",{type:"text",value:x,onChange:e=>u(e.target.value),placeholder:"Class # (e.g., 4337)",className:"input sm:w-40",maxLength:5,required:!0}),(0,s.jsx)("button",{type:"submit",className:"btn-primary",disabled:n,children:n?"Adding...":"Add Class"})]}),h&&(0,s.jsx)("p",{className:"mt-3 text-red-400 text-sm",children:h}),j&&(0,s.jsx)("p",{className:"mt-3 text-green-400 text-sm",children:j})]}),0===l.length?(0,s.jsxs)("div",{className:"card text-center py-12",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ“š"}),(0,s.jsx)("p",{className:"text-[var(--foreground-muted)]",children:"No classes on your watchlist yet. Add one above!"})]}):(0,s.jsx)("div",{className:"space-y-4",children:l.map(e=>(0,s.jsxs)("div",{className:"card flex items-center justify-between animate-fade-in",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:`text-2xl ${e.isOpen?"animate-pulse":""}`,children:e.isOpen?"ðŸŸ¢":"ðŸ”´"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-semibold text-lg",children:[e.subject," ",e.catalogNbr]}),e.title&&(0,s.jsx)("p",{className:"text-[var(--foreground-muted)] text-sm",children:e.title})]})]}),(0,s.jsxs)("div",{className:"mt-2 text-sm text-[var(--foreground-muted)]",children:[e.isOpen?(0,s.jsxs)("span",{className:"status-open font-medium",children:[e.seatsAvailable," seat",1!==e.seatsAvailable?"s":""," available!"]}):(0,s.jsx)("span",{children:"Currently closed"}),e.lastChecked&&(0,s.jsxs)("span",{className:"ml-3",children:["â€¢ Last checked: ",new Date(e.lastChecked).toLocaleString()]})]})]}),(0,s.jsx)("button",{onClick:()=>N(e.id),className:"text-[var(--foreground-muted)] hover:text-red-400 transition-colors p-2",title:"Remove from watchlist",children:"âœ•"})]},e.id))}),(0,s.jsx)("div",{className:"mt-8 p-4 rounded-lg bg-[var(--background-tertiary)] text-sm text-[var(--foreground-muted)]",children:(0,s.jsx)("p",{children:"ðŸ”” We check for class openings every 2 hours. When a seat opens up, you'll receive an email notification immediately."})})]})]})}e.s(["default",()=>l])}]);